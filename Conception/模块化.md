<!--
 * @Author: your name
 * @Date: 2020-02-25 10:53:46
 * @LastEditTime: 2022-05-25 16:11:35
 * @LastEditors: Juliette.Wang nannan.wang@broadlink.com.cn
 * @Description: In User Settings Edit
 * @FilePath: \vue-note\模块化.md
 -->

# 模块化

## 定义

- 将一个复杂的程序，根据一定的规则分成几个块文件，并进行组合的过程

## 标准

- commonJS
  - 使用框架：nodejs
  - 导入：require
  - 导出：module.exports/exports
- AMD
  - 导入: require
  - 导出: defined
  - requirejs 的执行规范，提前执行，推崇依赖前置
- CMD
  - seajs 的执行规范，延迟执行，推崇依赖就近
- ES6 的 modules
  - 导入：import
  - 导出：export

## 对模块化的理解

- 我对模块的理解是，模块是解决一个特定功能的一组方法，项目最开始时比较简单，直接使用 js 实现功能，没有模块的概念，但是随着项目逻辑越来越复杂，模块化开发就变得越来越重要
- 由于函数具有独立作用域的特点，最初是使用函数实现模块，但是函数会导致全局变量的污染，而且模块之间没有关联
- 后来是将函数作为对象的方法实现，这个方式解决了函数模块的问题，但是外部可以访问对象的所有成员，并可以修改这些属性
- 现在最常用的是立即执行函数，利用闭包构造私有作用域，解决这个问题

## 作用

- 避免全局变量冲突
- 代码分离，按需加载
- 更高的代码复用率
- 更高的可维护性

## require 和 import 的区别

- require 是同步的，import 是异步的
- require 支持动态导入，import 不支持
- require 是值拷贝，import 是地址拷贝

# 工程化

提高前端开发效率，提高前端开发质量的方法和工具都属于工程化，包括模块化、组件化、规范化、自动化。广义上的工程化是从编码到部署，运行和维护阶段。工程化的意义是提高开发效率，提高产品质量，降低开发难度，降低企业成本。

## webpack 构建流程

### 核心概念

- entry 入口，webpack 模块解析入口，从 entry 入口开始，根据模块的依赖关系，递归解析和处理资源文件
- output 输出，经过 webpack 编译后的产物
- loader 转换器，本质是函数，可以将一个文件转换成另外一种文件，比如 less-loader 把 less 文件转成 css
- plugin 扩展器，丰富 webpack 功能，针对 loader 之后，webpack 打包的整个过程，不直接操作文件，而是基于事件流，监听打包过程的事件钩子执行任务
- moudle 模块，除了 es module 及 commonjs 等，图片、字体也被视为模块

### webpack 术语

- moudle 指在模块化编程中，将应用程序分割成独立的代码模块
- chunk 模块按照引用关系组合成的代码块，一个 chunk 里面可以有多个 moudle
- bundling 代码打包过程
- asset/bundle 打包产物

### 打包思想

- webpack 从 entry 文件开始，通过依赖关系递归解析和处理模块
- 每一个入口都是一个 chunk，每个 chunk 包含递归分析依赖的所有模块，每个 chunk 对应一个 webpack 编译后的 bundle 产物
- 一切源代码都可以通过 loader 转换成 js 模块 module，模块之间可以互相引用

### 打包流程

- 初始化参数，webpack cli 启动打包流程
- 载入 webpack 核心核心模块，创建 Compiler 对象
- 开始编译，使用 Compiler 开始编译整个项目
- 编译模块，从入口文件开始，解析模块依赖，形成依赖关系树
- 完成编译，递归依赖关系树，将每个模块交给对应的 loader 处理
- 输出资源，合并 loader 处理完的结果，将打包结果输出到目录
- 在 webpack 打包的整个过程，plugin 会监听事件钩子，执行特定的逻辑
